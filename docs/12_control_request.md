# Control Request

> Stdin input messages for mid-session configuration changes.
> Uses `control_request`/`control_response` message types.

- [Permission mode change via set_permission_mode control request](#permission-mode-change-via-set_permission_mode-control-request)
- [Model change via set_model control request](#model-change-via-set_model-control-request)

## Permission mode change via set_permission_mode control request

<table>
<tr><th>direction</th><th>message</th><th>json</th></tr>
<tr><td>&lt;-</td><td><a href="../README.md#user">user</a></td><td><pre lang="json">
{
  "type": "user",
  "message": {
    "role": "user",
    "content": "hello"
  }
}
</pre></td></tr>
<tr><td>-&gt;</td><td><a href="../README.md#systeminit">system/init</a></td><td><pre lang="json">
{
  "type": "system",
  "subtype": "init",
  "cwd": "/home/user/project",
  "session_id": "session-abc123",
  "tools": [
    "Bash",
    "Read",
    "Write",
    "Edit",
    "Glob",
    "Grep"
  ],
  "mcp_servers": [],
  "model": "claude-sonnet-4-5-20250929",
  "permissionMode": "bypassPermissions",
  "slash_commands": [],
  "apiKeySource": "env_variable",
  "claude_code_version": "2.1.0",
  "output_style": "default",
  "agents": [],
  "skills": [],
  "plugins": [],
  "uuid": "uuid-abc123",
  "fast_mode_state": "off"
}
</pre></td></tr>
<tr><td>-&gt;</td><td><a href="../README.md#resultsuccess">result/success</a></td><td><pre lang="json">
{
  "type": "result",
  "subtype": "success",
  "is_error": false,
  "duration_ms": 100,
  "duration_api_ms": 50,
  "num_turns": 1,
  "result": "Ready.",
  "session_id": "session-abc123",
  "total_cost_usd": 0.001,
  "usage": {
    "input_tokens": 10,
    "output_tokens": 1
  },
  "modelUsage": {
    "claude-sonnet-4-5-20250929": {
      "input_tokens": 10,
      "output_tokens": 1
    }
  },
  "permission_denials": [],
  "uuid": "uuid-abc123"
}
</pre></td></tr>
<tr><td>&lt;-</td><td><a href="../README.md#control_request">control_request</a></td><td><pre lang="json">
{
  "type": "control_request",
  "request_id": "test-perm-001",
  "request": {
    "subtype": "set_permission_mode",
    "mode": "plan"
  }
}
</pre></td></tr>
<tr><td>&lt;-</td><td><a href="../README.md#user">user</a></td><td><pre lang="json">
{
  "type": "user",
  "message": {
    "role": "user",
    "content": "hi"
  }
}
</pre></td></tr>
<tr><td>-&gt;</td><td><a href="../README.md#control_response">control_response</a></td><td><pre lang="json">
{
  "type": "control_response",
  "response": {
    "subtype": "success",
    "request_id": "request-abc123",
    "response": {
      "mode": "plan"
    }
  }
}
</pre></td></tr>
<tr><td>-&gt;</td><td><a href="../README.md#systeminit">system/init</a></td><td><pre lang="json">
{
  "type": "system",
  "subtype": "init",
  "cwd": "/home/user/project",
  "session_id": "session-abc123",
  "tools": [
    "Bash",
    "Read",
    "Write",
    "Edit",
    "Glob",
    "Grep"
  ],
  "mcp_servers": [],
  "model": "claude-sonnet-4-5-20250929",
  "permissionMode": "plan",
  "slash_commands": [],
  "apiKeySource": "env_variable",
  "claude_code_version": "2.1.0",
  "output_style": "default",
  "agents": [],
  "skills": [],
  "plugins": [],
  "uuid": "uuid-abc123",
  "fast_mode_state": "off"
}
</pre></td></tr>
<tr><td>-&gt;</td><td><a href="../README.md#resultsuccess">result/success</a></td><td><pre lang="json">
{
  "type": "result",
  "subtype": "success",
  "is_error": false,
  "duration_ms": 100,
  "duration_api_ms": 50,
  "num_turns": 1,
  "result": "Hello!",
  "session_id": "session-abc123",
  "total_cost_usd": 0.001,
  "usage": {
    "input_tokens": 10,
    "output_tokens": 1
  },
  "modelUsage": {
    "claude-sonnet-4-5-20250929": {
      "input_tokens": 10,
      "output_tokens": 1
    }
  },
  "permission_denials": [],
  "uuid": "uuid-abc123"
}
</pre></td></tr>
</table>

## Model change via set_model control request

<table>
<tr><th>direction</th><th>message</th><th>json</th></tr>
<tr><td>&lt;-</td><td><a href="../README.md#user">user</a></td><td><pre lang="json">
{
  "type": "user",
  "message": {
    "role": "user",
    "content": "hello"
  }
}
</pre></td></tr>
<tr><td>-&gt;</td><td><a href="../README.md#systeminit">system/init</a></td><td><pre lang="json">
{
  "type": "system",
  "subtype": "init",
  "cwd": "/home/user/project",
  "session_id": "session-abc123",
  "tools": [
    "Bash",
    "Read",
    "Write",
    "Edit",
    "Glob",
    "Grep"
  ],
  "mcp_servers": [],
  "model": "claude-sonnet-4-5-20250929",
  "permissionMode": "bypassPermissions",
  "slash_commands": [],
  "apiKeySource": "env_variable",
  "claude_code_version": "2.1.0",
  "output_style": "default",
  "agents": [],
  "skills": [],
  "plugins": [],
  "uuid": "uuid-abc123",
  "fast_mode_state": "off"
}
</pre></td></tr>
<tr><td>-&gt;</td><td><a href="../README.md#resultsuccess">result/success</a></td><td><pre lang="json">
{
  "type": "result",
  "subtype": "success",
  "is_error": false,
  "duration_ms": 100,
  "duration_api_ms": 50,
  "num_turns": 1,
  "result": "Ready.",
  "session_id": "session-abc123",
  "total_cost_usd": 0.001,
  "usage": {
    "input_tokens": 10,
    "output_tokens": 1
  },
  "modelUsage": {
    "claude-sonnet-4-5-20250929": {
      "input_tokens": 10,
      "output_tokens": 1
    }
  },
  "permission_denials": [],
  "uuid": "uuid-abc123"
}
</pre></td></tr>
<tr><td>&lt;-</td><td><a href="../README.md#control_request">control_request</a></td><td><pre lang="json">
{
  "type": "control_request",
  "request_id": "test-model-001",
  "request": {
    "subtype": "set_model",
    "model": "sonnet"
  }
}
</pre></td></tr>
<tr><td>&lt;-</td><td><a href="../README.md#user">user</a></td><td><pre lang="json">
{
  "type": "user",
  "message": {
    "role": "user",
    "content": "hi"
  }
}
</pre></td></tr>
<tr><td>-&gt;</td><td><a href="../README.md#control_response">control_response</a></td><td><pre lang="json">
{
  "type": "control_response",
  "response": {
    "subtype": "success",
    "request_id": "request-abc123"
  }
}
</pre></td></tr>
<tr><td>-&gt;</td><td><a href="../README.md#systeminit">system/init</a></td><td><pre lang="json">
{
  "type": "system",
  "subtype": "init",
  "cwd": "/home/user/project",
  "session_id": "session-abc123",
  "tools": [
    "Bash",
    "Read",
    "Write",
    "Edit",
    "Glob",
    "Grep"
  ],
  "mcp_servers": [],
  "model": "claude-sonnet-4-5-20250929",
  "permissionMode": "bypassPermissions",
  "slash_commands": [],
  "apiKeySource": "env_variable",
  "claude_code_version": "2.1.0",
  "output_style": "default",
  "agents": [],
  "skills": [],
  "plugins": [],
  "uuid": "uuid-abc123",
  "fast_mode_state": "off"
}
</pre></td></tr>
<tr><td>-&gt;</td><td><a href="../README.md#resultsuccess">result/success</a></td><td><pre lang="json">
{
  "type": "result",
  "subtype": "success",
  "is_error": false,
  "duration_ms": 100,
  "duration_api_ms": 50,
  "num_turns": 1,
  "result": "Hello!",
  "session_id": "session-abc123",
  "total_cost_usd": 0.001,
  "usage": {
    "input_tokens": 10,
    "output_tokens": 1
  },
  "modelUsage": {
    "claude-sonnet-4-5-20250929": {
      "input_tokens": 10,
      "output_tokens": 1
    }
  },
  "permission_denials": [],
  "uuid": "uuid-abc123"
}
</pre></td></tr>
</table>

